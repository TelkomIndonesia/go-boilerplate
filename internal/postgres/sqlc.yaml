version: "2"
plugins:
  - name: golang
    wasm:
      url: https://github.com/TelkomIndonesia/sqlc-gen-go/releases/download/v1.500.0/sqlc-gen-go_1.500.0_wasip1_wasm
      sha256: 30caffb48563dc859124a882c7d9d033043910f3a048da8385d41ec118810482
sql:
  # used when `generate`
  - engine: "postgresql"
    queries: "query.sql"
    schema: "schema.sql"
    codegen:
      - plugin: golang
        out: "internal/sqlc"
        options:
          package: "sqlc"
          sql_package: "database/sql"
          emit_sql_as_comment: true
          overrides:
            - column: profile.nin
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: AEADString
            - column: profile.name
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: AEADString
            - column: profile.phone
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: AEADString
            - column: profile.email
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: AEADString
            - column: profile.dob
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: AEADTime
            - column: profile.nin_bidx
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: BIDXString
            - column: profile.name_bidx
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: BIDXString
            - column: profile.phone_bidx
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: BIDXString
            - column: profile.email_bidx
              go_type:
                import: github.com/telkomindonesia/go-boilerplate/internal/postgres/internal/sqlc/types
                type: BIDXString

  # used in `make explain`
  - engine: "postgresql"
    queries: "query.sql"
    database:
      uri: "postgresql://testing:testing@localhost:5432/testing?sslmode=disable"
